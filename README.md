# UP-Retinex: Unsupervised Physics-Guided Retinex Network

åŸºäºRetinexç†è®ºçš„æ— ç›‘ç£ä½å…‰ç…§å›¾åƒå¢å¼ºç½‘ç»œ

## ğŸ“š ç†è®ºåŸºç¡€

### Retinexç†è®º
Retinexç†è®ºç”±Landå’ŒMcCannåœ¨1970å¹´ä»£æå‡ºï¼Œæ—¨åœ¨è§£é‡Šäººç±»è§†è§‰ç³»ç»Ÿå¦‚ä½•åœ¨ä¸åŒå…‰ç…§æ¡ä»¶ä¸‹æ„ŸçŸ¥ç‰©ä½“çš„çœŸå®é¢œè‰²å’Œäº®åº¦ã€‚è¯¥ç†è®ºçš„æ ¸å¿ƒæ€æƒ³æ˜¯å°†å›¾åƒåˆ†è§£ä¸ºä¸¤ä¸ªç»„æˆéƒ¨åˆ†ï¼š
- **å…‰ç…§åˆ†é‡ï¼ˆIllumination Componentï¼‰**ï¼šè¡¨ç¤ºåœºæ™¯çš„æ•´ä½“ç…§æ˜æƒ…å†µ
- **åå°„åˆ†é‡ï¼ˆReflectance Componentï¼‰**ï¼šè¡¨ç¤ºç‰©ä½“è¡¨é¢çš„å›ºæœ‰å±æ€§

æ•°å­¦å…¬å¼å¯ä»¥è¡¨ç¤ºä¸ºï¼šI(x,y) = L(x,y) Ã— R(x,y)

å…¶ä¸­ï¼š
- I(x,y) æ˜¯è§‚å¯Ÿåˆ°çš„å›¾åƒå¼ºåº¦
- L(x,y) æ˜¯å…‰ç…§åˆ†é‡
- R(x,y) æ˜¯åå°„åˆ†é‡

### Retinexåˆ†è§£åŸç†
åœ¨æ•°å­—å›¾åƒå¤„ç†ä¸­ï¼ŒRetinexåˆ†è§£çš„ç›®æ ‡æ˜¯ä»å•å¼ ä½å…‰ç…§å›¾åƒä¸­ä¼°è®¡å‡ºå…‰ç…§åˆ†é‡ï¼Œå¹¶æ®æ­¤è®¡ç®—å‡ºåå°„åˆ†é‡ä»¥è·å¾—å¢å¼ºåçš„å›¾åƒã€‚å…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š
1. å¯¹è¾“å…¥å›¾åƒIè¿›è¡Œé«˜æ–¯æ»¤æ³¢å¾—åˆ°å…‰ç…§ä¼°è®¡L
2. é€šè¿‡R = I/Lè®¡ç®—åå°„åˆ†é‡
3. å¯¹åå°„åˆ†é‡è¿›è¡Œä¼½é©¬æ ¡æ­£å¾—åˆ°æœ€ç»ˆå¢å¼ºå›¾åƒ

## âš™ï¸ æŠ€æœ¯æ¶æ„

### ç½‘ç»œæ¶æ„æ¦‚è¿°
UP-Retinexé‡‡ç”¨äº†ç¼–ç å™¨-è§£ç å™¨æ¶æ„ï¼Œç»“åˆäº†ç‰¹å¾èšåˆæ¨¡å—(FAM)å’Œå…‰ç…§ä¼°è®¡ç½‘ç»œ(IENet)ï¼Œèƒ½å¤Ÿæœ‰æ•ˆä¼°è®¡å…‰ç…§å›¾å¹¶è¿›è¡Œå›¾åƒå¢å¼ºã€‚

### æ ¸å¿ƒæ¨¡å—è¯¦è§£

#### Enhanced Feature Aggregation Module (Enhanced FAM)
Enhanced FAMæ¨¡å—é€šè¿‡å¤šåˆ†æ”¯ç‰¹å¾æå–å’Œæ³¨æ„åŠ›æœºåˆ¶å¢å¼ºç‰¹å¾è¡¨è¾¾èƒ½åŠ›ã€‚å®ƒåŒ…å«ä»¥ä¸‹ç»„ä»¶ï¼š
- å¤šåˆ†æ”¯å·ç§¯å±‚ï¼šåˆ†åˆ«ä½¿ç”¨3Ã—3, 5Ã—5, 7Ã—7å·ç§¯æ ¸æå–ä¸åŒå°ºåº¦çš„ç‰¹å¾
- æ³¨æ„åŠ›æœºåˆ¶ï¼šç»“åˆé€šé“æ³¨æ„åŠ›(SE Block)å’Œç©ºé—´æ³¨æ„åŠ›æœºåˆ¶
- ç‰¹å¾èåˆï¼šå°†å¤šå°ºåº¦ç‰¹å¾è¿›è¡ŒåŠ æƒèåˆ

#### Residual Illumination Estimation Network (Residual IENet)
Residual IENeté‡‡ç”¨U-Neté£æ ¼çš„ç¼–ç å™¨-è§£ç å™¨ç»“æ„ï¼Œä¸“é—¨ç”¨äºä¼°è®¡å…‰ç…§å›¾ã€‚å…¶ä¸»è¦ç‰¹ç‚¹åŒ…æ‹¬ï¼š
- ç¼–ç å™¨éƒ¨åˆ†ï¼šé€æ­¥ä¸‹é‡‡æ ·æå–é«˜å±‚è¯­ä¹‰ç‰¹å¾
- è§£ç å™¨éƒ¨åˆ†ï¼šé€æ­¥ä¸Šé‡‡æ ·æ¢å¤ç©ºé—´åˆ†è¾¨ç‡
- æ®‹å·®è¿æ¥ï¼šå¼•å…¥æ®‹å·®å­¦ä¹ æœºåˆ¶æé«˜è®­ç»ƒç¨³å®šæ€§
- è¾“å‡ºå¤„ç†ï¼šç”Ÿæˆä¸è¾“å…¥å›¾åƒç›¸åŒå°ºå¯¸çš„å…‰ç…§å›¾

#### Multi-Scale UP-Retinex
Multi-Scale UP-Retinexæ•´åˆäº†Enhanced FAMå’ŒResidual IENetï¼Œå½¢æˆäº†å®Œæ•´çš„å›¾åƒå¢å¼ºç½‘ç»œã€‚å…¶å·¥ä½œæµç¨‹å¦‚ä¸‹ï¼š
1. è¾“å…¥å›¾åƒé¦–å…ˆç»è¿‡Enhanced FAMæå–å¤šå°ºåº¦ç‰¹å¾
2. ç‰¹å¾è¢«é€å…¥Residual IENetä¼°è®¡å…‰ç…§å›¾
3. åˆ©ç”¨Retinexåˆ†è§£åŸç†è®¡ç®—åå°„åˆ†é‡
4. åº”ç”¨ä¼½é©¬æ ¡æ­£å¾—åˆ°æœ€ç»ˆå¢å¼ºå›¾åƒ

## âš™ï¸ å®‰è£…è¯´æ˜

### ç¯å¢ƒè¦æ±‚
- Python >= 3.7
- PyTorch >= 1.8.0
- torchvision >= 0.9.0
- CUDA >= 10.2 (å¦‚æœä½¿ç”¨GPU)
- å…¶ä»–ä¾èµ–è§requirements.txt

### å®‰è£…æ­¥éª¤
1. å…‹éš†ä»“åº“ï¼š
   ```bash
   git clone https://github.com/yourusername/UP-Retinex.git
   cd UP-Retinex
   ```

2. åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ(æ¨è)ï¼š
   ```bash
   conda create -n up_retinex python=3.8
   conda activate up_retinex
   ```

3. å®‰è£…ä¾èµ–ï¼š
   ```bash
   pip install -r requirements.txt
   ```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒå®‰è£…

```bash
pip install -r requirements.txt
```

### æ•°æ®å‡†å¤‡

ç»„ç»‡æ‚¨çš„æ•°æ®é›†å¦‚ä¸‹ï¼š
```
data/
â”œâ”€â”€ train/
â”‚   â”œâ”€â”€ 0001.png
â”‚   â”œâ”€â”€ 0002.png
â”‚   â””â”€â”€ ...
â””â”€â”€ test/
    â”œâ”€â”€ 0001.png
    â”œâ”€â”€ 0002.png
    â””â”€â”€ ...
```

æ”¯æŒçš„å›¾åƒæ ¼å¼ï¼šJPEG, PNG, BMP

### è®­ç»ƒæ¨¡å‹

```bash
# åŸºç¡€è®­ç»ƒ
python main.py --mode train --train_data_path ./data/train --val_data_path ./data/test

# è‡ªå®šä¹‰è¶…å‚æ•°
python main.py --mode train --train_data_path ./data/train --val_data_path ./data/test \
               --learning_rate 1e-4 --batch_size 8 --epochs 200
```

### æ¨ç†é¢„æµ‹

```bash
# å•å¼ å›¾åƒé¢„æµ‹
python main.py --mode predict --input_path ./test_image.jpg --output_dir ./results

# æ‰¹é‡é¢„æµ‹
python main.py --mode predict --input_path ./data/test --output_dir ./results
```

### ç®€åŒ–ç‰ˆå›¾åƒå¢å¼º

å¯¹äºä¸éœ€è¦è®­ç»ƒçš„å¿«é€Ÿå›¾åƒå¢å¼ºï¼Œæˆ‘ä»¬æä¾›äº†ç®€åŒ–ç‰ˆæœ¬ï¼š

```bash
# å•å¼ å›¾åƒå¢å¼º
python simple_enhance.py --input ./your_image.jpg --output ./results

# æ‰¹é‡å›¾åƒå¢å¼º
python simple_enhance.py --input ./data/input_directory --output ./results

# ä½¿ç”¨letterboxç­–ç•¥ä¿æŒå®½é«˜æ¯”
python simple_enhance.py --input ./your_image.jpg --output ./results --letterbox --image_size 320

# å¤šå°ºåº¦å¢å¼º
python simple_enhance.py --input ./your_image.jpg --output ./results --multi_scale

# å†…å®¹æ„ŸçŸ¥å¢å¼º
python simple_enhance.py --input ./your_image.jpg --output ./results --content_aware
```

**ç®€åŒ–ç‰ˆå‚æ•°ï¼š**
- `--input`ï¼šè¾“å…¥å›¾åƒè·¯å¾„æˆ–ç›®å½•ï¼ˆå¿…éœ€ï¼‰
- `--output`ï¼šä¿å­˜ç»“æœçš„ç›®å½•(é»˜è®¤ï¼š`./results`)
- `--image_size`ï¼šå¤„ç†å›¾åƒå°ºå¯¸(å¯é€‰ï¼Œé»˜è®¤ä¸ºåŸå›¾å°ºå¯¸)
- `--letterbox`ï¼šä½¿ç”¨letterboxç­–ç•¥ä¿æŒå®½é«˜æ¯”(å¯é€‰)
- `--device`ï¼šä½¿ç”¨çš„è®¾å¤‡(cuda/cpu)
- `--multi_scale`ï¼šå¯ç”¨å¤šå°ºåº¦å¢å¼ºæ¨¡å¼
- `--content_aware`ï¼šå¯ç”¨å†…å®¹æ„ŸçŸ¥å¢å¼ºæ¨¡å¼

### 5. ä¸»ç¨‹åºä¸­çš„ç®€åŒ–å¢å¼ºæ¨¡å¼

æ‚¨ä¹Ÿå¯ä»¥é€šè¿‡ä¸»ç¨‹åºä½¿ç”¨ç®€åŒ–å¢å¼ºæ¨¡å¼ï¼š

**å•å¼ å›¾åƒå¢å¼ºï¼š**
```bash
python main.py --mode enhance --input_path ./your_image.jpg --output_dir ./results
```

**æ‰¹é‡å›¾åƒå¢å¼ºï¼š**
```bash
python main.py --mode enhance --input_path ./data/input_directory --output_dir ./results
```

### 6. é«˜çº§å¢å¼ºåŠŸèƒ½

æœ¬é¡¹ç›®å®ç°äº†å¤šç§é«˜çº§å›¾åƒå¢å¼ºæŠ€æœ¯ï¼Œä»¥æ»¡è¶³ä¸åŒåœºæ™¯çš„éœ€æ±‚ï¼š

#### å¤šå°ºåº¦å¢å¼º (Multi-Scale Enhancement)
å¤šå°ºåº¦å¢å¼ºæŠ€æœ¯é€šè¿‡æ„å»ºå›¾åƒé‡‘å­—å¡”ï¼Œåœ¨ä¸åŒå°ºåº¦ä¸Šè¿›è¡Œç‰¹å¾æå–å’Œå¢å¼ºï¼Œèƒ½å¤Ÿæ›´å¥½åœ°ä¿ç•™å›¾åƒç»†èŠ‚å¹¶æå‡æ•´ä½“è§†è§‰æ•ˆæœã€‚

ç‰¹ç‚¹ï¼š
- åœ¨å¤šä¸ªå°ºåº¦ä¸Šæå–å›¾åƒç‰¹å¾
- æœ‰æ•ˆä¿ç•™ç»†èŠ‚ä¿¡æ¯
- æå‡å›¾åƒçš„æ•´ä½“å¯¹æ¯”åº¦å’Œæ¸…æ™°åº¦

ä½¿ç”¨æ–¹æ³•ï¼š
```bash
python simple_enhance.py --input ./your_image.jpg --output ./results --multi_scale
```

#### å†…å®¹æ„ŸçŸ¥å¢å¼º (Content-Aware Enhancement)
å†…å®¹æ„ŸçŸ¥å¢å¼ºæŠ€æœ¯ç»“åˆäº†æ˜¾è‘—æ€§æ£€æµ‹å’Œæ³¨æ„åŠ›æœºåˆ¶ï¼Œèƒ½å¤Ÿè¯†åˆ«å›¾åƒä¸­çš„é‡è¦åŒºåŸŸï¼Œå¹¶é’ˆå¯¹æ€§åœ°å¢å¼ºè¿™äº›åŒºåŸŸï¼Œä»è€Œè·å¾—æ›´è‡ªç„¶çš„å¢å¼ºæ•ˆæœã€‚

ç‰¹ç‚¹ï¼š
- è‡ªåŠ¨è¯†åˆ«å›¾åƒä¸­çš„æ˜¾è‘—åŒºåŸŸ
- æ ¹æ®å†…å®¹é‡è¦æ€§è°ƒæ•´å¢å¼ºå¼ºåº¦
- æä¾›æ›´åŠ è‡ªç„¶å’Œç¬¦åˆäººçœ¼è§†è§‰çš„å¢å¼ºæ•ˆæœ

ä½¿ç”¨æ–¹æ³•ï¼š
```bash
python simple_enhance.py --input ./your_image.jpg --output ./results --content_aware
```

### å‚æ•°è¯´æ˜

#### è®­ç»ƒå‚æ•°
- `--num_epochs`: è®­ç»ƒè½®æ•° (é»˜è®¤: 100)
- `--batch_size`: æ‰¹å¤„ç†å¤§å° (é»˜è®¤: 8)
- `--image_size`: è®­ç»ƒå›¾åƒå°ºå¯¸ (é»˜è®¤: 640)
- `--lr`: å­¦ä¹ ç‡ (é»˜è®¤: 1e-4)
- `--weight_decay`: æƒé‡è¡°å‡ (é»˜è®¤: 1e-5)

#### æŸå¤±å‡½æ•°æƒé‡
- `--weight_exp`: æ›å…‰æ§åˆ¶æŸå¤±æƒé‡ (é»˜è®¤: 10.0)
- `--weight_smooth`: å¹³æ»‘æ€§æŸå¤±æƒé‡ (é»˜è®¤: 1.0)
- `--weight_col`: é¢œè‰²æ’å¸¸æ€§æŸå¤±æƒé‡ (é»˜è®¤: 0.5)
- `--weight_spa`: ç©ºé—´ä¸€è‡´æ€§æŸå¤±æƒé‡ (é»˜è®¤: 1.0)

#### æ¨ç†å‚æ•°
- `--max_size`: æœ€å¤§å›¾åƒå°ºå¯¸ (é»˜è®¤: None)
- `--device`: è¿è¡Œè®¾å¤‡ (é»˜è®¤: cuda if available else cpu)

### TensorBoardç›‘æ§

ä½¿ç”¨TensorBoardç›‘æ§è®­ç»ƒè¿›åº¦ï¼š

```bash
tensorboard --logdir ./checkpoints/logs
```

ç„¶ååœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ http://localhost:6006

## ğŸ“Š æŸå¤±å‡½æ•°

æ¨¡å‹ä½¿ç”¨å››ç§æ— ç›‘ç£æŸå¤±å‡½æ•°ï¼š

### 1. æ›å…‰æ§åˆ¶æŸå¤±(L_exp)
çº¦æŸå¢å¼ºå›¾åƒçš„å¹³å‡å¼ºåº¦è¾¾åˆ°ç›®æ ‡æ°´å¹³(0.6)ã€‚

$$\mathcal{L}_{exp} = \frac{1}{M} \sum_{k=1}^{M} |Y_k - E|$$

### 2. ç»“æ„æ„ŸçŸ¥å¹³æ»‘æ€§æŸå¤±(L_smooth)
ç¡®ä¿å…‰ç…§å¹³æ»‘åŒæ—¶ä¿ç•™è¾¹ç¼˜ã€‚

$$\mathcal{L}_{smooth} = \sum || \nabla I \circ \exp(-\lambda |\nabla S|) ||_1$$

### 3. é¢œè‰²æ’å¸¸æ€§æŸå¤±(L_col)
åŸºäºç°åº¦ä¸–ç•Œå‡è®¾æ¥æ ¡æ­£é¢œè‰²åå·®ã€‚

$$\mathcal{L}_{col} = \sum_{\forall (p,q) \in (R,G,B), p \neq q} (J^p - J^q)^2$$

### 4. ç©ºé—´ä¸€è‡´æ€§æŸå¤±(L_spa)
ä¿æŒä»è¾“å…¥åˆ°è¾“å‡ºçš„çº¹ç†ç»“æ„ã€‚

$$\mathcal{L}_{spa} = \frac{1}{K} \sum_{i=1}^{K} || \nabla R_i - \nabla S_i ||^2$$

### æ€»æŸå¤±

$$\mathcal{L}_{total} = \mathcal{L}_{exp} + \omega_{smooth}\mathcal{L}_{smooth} + \omega_{col}\mathcal{L}_{col} + \omega_{spa}\mathcal{L}_{spa}$$

## ğŸ“ é¡¹ç›®ç»“æ„

```
.
â”œâ”€â”€ models/               # æ¨¡å‹æ¶æ„ç›®å½•
â”‚   â””â”€â”€ model.py          # æ¨¡å‹æ¶æ„(FAM, IENet, UP_Retinex)
â”œâ”€â”€ losses/               # æŸå¤±å‡½æ•°ç›®å½•
â”‚   â””â”€â”€ loss.py           # æŸå¤±å‡½æ•°
â”œâ”€â”€ datasets/             # æ•°æ®åŠ è½½å·¥å…·ç›®å½•
â”‚   â””â”€â”€ dataset.py        # æ•°æ®åŠ è½½å·¥å…·
â”œâ”€â”€ trainers/             # è®­ç»ƒè„šæœ¬ç›®å½•
â”‚   â””â”€â”€ train.py          # è®­ç»ƒè„šæœ¬
â”œâ”€â”€ predictors/           # æ¨ç†è„šæœ¬ç›®å½•
â”‚   â””â”€â”€ predict.py        # æ¨ç†è„šæœ¬
â”œâ”€â”€ enhancers/            # å›¾åƒå¢å¼ºåŠŸèƒ½ç›®å½•
â”‚   â”œâ”€â”€ simple_enhance.py # ç®€åŒ–ç‰ˆå›¾åƒå¢å¼ºæ ¸å¿ƒåŠŸèƒ½
â”‚   â”œâ”€â”€ adaptive_params.py# è‡ªé€‚åº”å‚æ•°è°ƒæ•´æ¨¡å—
â”‚   â”œâ”€â”€ multi_scale.py    # å¤šå°ºåº¦å¢å¼ºæ¨¡å—
â”‚   â””â”€â”€ content_aware.py  # å†…å®¹æ„ŸçŸ¥å¢å¼ºæ¨¡å—
â”œâ”€â”€ utils/                # å®ç”¨å·¥å…·ç›®å½•
â”‚   â”œâ”€â”€ letterbox.py      # Letterboxå¤„ç†å·¥å…·
â”‚   â””â”€â”€ utils.py          # å®ç”¨å·¥å…·å‡½æ•°
â”œâ”€â”€ main.py               # ä¸»ç¨‹åºå…¥å£
â”œâ”€â”€ simple_enhance.py     # ç®€åŒ–ç‰ˆå›¾åƒå¢å¼ºå·¥å…·ï¼ˆå¯ç›´æ¥ä½¿ç”¨ï¼Œæ— éœ€è®­ç»ƒï¼‰
â”œâ”€â”€ enhancement_comparison_report.md # å¢å¼ºæ•ˆæœå¯¹æ¯”æŠ¥å‘Š
â”œâ”€â”€ requirements.txt      # Pythonä¾èµ–
â”œâ”€â”€ Development Documentation.md  # è¯¦ç»†è§„èŒƒè¯´æ˜
â”œâ”€â”€ REFACTORING_SUMMARY.md       # é‡æ„æ€»ç»“
â””â”€â”€ README.md             # æœ¬æ–‡æ¡£
```

## ğŸ§ª æµ‹è¯•ç»„ä»¶

### æµ‹è¯•æ•´ä¸ªé¡¹ç›®
```bash
python test_project.py
```

### æµ‹è¯•æ¨¡å‹æ¶æ„
```bash
python models/model.py
```

### æµ‹è¯•æŸå¤±å‡½æ•°
```bash
python losses/loss.py
```

### æµ‹è¯•æ•°æ®é›†åŠ è½½å™¨
```bash
python datasets/dataset.py ./data/train
```

## ğŸ”§ è¶…å‚æ•°

é»˜è®¤è¶…å‚æ•°(æ ¹æ®è§„èŒƒ)ï¼š

| å‚æ•° | å€¼ |
|-----------|-------|
| å­¦ä¹ ç‡ | 1e-4 |
| æƒé‡è¡°å‡ | 1e-5 |
| æ‰¹å¤„ç†å¤§å° | 8 |
| å›¾åƒå°ºå¯¸ | 256Ã—256 |
| æ›å…‰æŸå¤±æƒé‡ | 10.0 |
| å¹³æ»‘æ€§æŸå¤±æƒé‡ | 1.0 |
| é¢œè‰²æŸå¤±æƒé‡ | 0.5 |
| ç©ºé—´æŸå¤±æƒé‡ | 1.0 |

## ğŸ“ˆ é¢„æœŸç»“æœ

æ¨¡å‹åº”äº§ç”Ÿï¼š
- **å¢å¼ºå›¾åƒ**ï¼šäº®åº¦å’Œå¯¹æ¯”åº¦å¾—åˆ°æ”¹å–„
- **å…‰ç…§å›¾**ï¼šæ˜¾ç¤ºä¼°è®¡çš„å…‰ç…§åˆ†å¸ƒ
- **å¯¹æ¯”å›¾åƒ**ï¼šæ˜¾ç¤ºè¾“å…¥ã€è¾“å‡ºå’Œå…‰ç…§çš„å¹¶æ’æ¯”è¾ƒ

## ğŸ¤ è´¡çŒ®

æ¬¢è¿ä»»ä½•å½¢å¼çš„è´¡çŒ®ï¼å¦‚æœæ‚¨æœ‰ä»»ä½•å»ºè®®æˆ–å‘ç°äº†bugï¼Œè¯·æäº¤issueæˆ–pull requestã€‚

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®åŸºäºMITè®¸å¯è¯å¼€æºã€‚

## ğŸ™ è‡´è°¢

æ„Ÿè°¢æ‰€æœ‰ä¸ºæœ¬é¡¹ç›®æä¾›å¸®åŠ©å’Œæ”¯æŒçš„äººä»¬ã€‚

## ğŸ› æ•…éšœæ’é™¤

### å†…å­˜ä¸è¶³(OOM)é”™è¯¯
- å‡å°‘æ‰¹å¤„ç†å¤§å°ï¼š`--batch_size 4`
- å‡å°‘å›¾åƒå°ºå¯¸ï¼š`--image_size 224`
- å¯¹äºæ¨ç†ï¼Œä½¿ç”¨letterboxç­–ç•¥å¹¶è®¾ç½®åˆé€‚çš„å°ºå¯¸ï¼š`--letterbox --image_size 1024`

### è®­ç»ƒæŸå¤±ä¸ä¸‹é™
- æ£€æŸ¥å›¾åƒæ˜¯å¦æ­£ç¡®å½’ä¸€åŒ–[0, 1]
- éªŒè¯æŸå¤±æƒé‡æ˜¯å¦åˆé€‚
- å°è¯•è°ƒæ•´å­¦ä¹ ç‡

### å¢å¼ºè´¨é‡å·®
- è®­ç»ƒæ›´å¤šè½®æ¬¡(æ¨è100-200è½®)
- ç¡®ä¿è®­ç»ƒæ•°æ®å¤šæ ·æ€§å……è¶³
- å¦‚å‡ºç°ç‰¹å®šä¼ªå½±ï¼Œè°ƒæ•´æŸå¤±æƒé‡

### é«˜çº§å¢å¼ºåŠŸèƒ½é—®é¢˜
- ç¡®ä¿å·²å®‰è£…æ‰€æœ‰ä¾èµ–é¡¹ï¼š`pip install -r requirements.txt`
- æ£€æŸ¥è¾“å…¥å›¾åƒæ ¼å¼æ˜¯å¦ä¸ºæ”¯æŒçš„æ ¼å¼ï¼ˆJPEG, PNGç­‰ï¼‰
- å¤šå°ºåº¦å¢å¼ºå’Œå†…å®¹æ„ŸçŸ¥å¢å¼ºå¯èƒ½éœ€è¦æ›´å¤šçš„è®¡ç®—èµ„æºï¼Œå¦‚æœé‡åˆ°æ€§èƒ½é—®é¢˜ï¼Œå¯ä»¥å°è¯•ä½¿ç”¨letterboxç­–ç•¥å¹¶è®¾ç½®åˆé€‚çš„å°ºå¯¸ï¼š`--letterbox --image_size 512`

### RuntimeError:ç»´åº¦ä¸åŒ¹é…é—®é¢˜
å¦‚æœé‡åˆ°ç±»ä¼¼"Expected size for first two dimensions of batch2 tensor to be: [1, 409600] but got: [1, 1228800]"çš„é”™è¯¯ï¼Œè¿™æ˜¯ç”±äºå…‰ç…§å›¾ï¼ˆå•é€šé“ï¼‰å’Œåå°„ç‡å›¾ï¼ˆä¸‰é€šé“ï¼‰ä¹‹é—´çš„ç»´åº¦ä¸åŒ¹é…å¯¼è‡´çš„ã€‚è¯¥é—®é¢˜å·²åœ¨æœ€æ–°ç‰ˆæœ¬ä¸­ä¿®å¤ï¼Œç¡®ä¿ä½¿ç”¨æœ€æ–°çš„ä»£ç ç‰ˆæœ¬å³å¯ã€‚

### AttributeError: 'Namespace' object has no attribute 'weight_xxx'
å¦‚æœé‡åˆ°å‚æ•°è®¿é—®é”™è¯¯ï¼Œè¿™æ˜¯ç”±äºå‘½ä»¤è¡Œå‚æ•°ç¼ºå¤±å¯¼è‡´çš„ã€‚è¯¥é—®é¢˜å·²åœ¨æœ€æ–°ç‰ˆæœ¬ä¸­ä¿®å¤ï¼Œé€šè¿‡ä¸ºæ‰€æœ‰æŸå¤±å‡½æ•°æƒé‡å‚æ•°æ·»åŠ é»˜è®¤å€¼å¤„ç†ï¼Œæé«˜äº†ä»£ç çš„å¥å£®æ€§ã€‚

### ValueError: too many values to unpack (expected 2)
å¦‚æœåœ¨ä½¿ç”¨è®­ç»ƒå¥½çš„æ¨¡å‹è¿›è¡Œå›¾åƒå¢å¼ºæ—¶é‡åˆ°æ­¤é”™è¯¯ï¼Œè¿™æ˜¯ç”±äºæ¨¡å‹è¿”å›å€¼æ•°é‡ä¸ä»£ç æœŸæœ›ä¸åŒ¹é…å¯¼è‡´çš„ã€‚è¯¥é—®é¢˜å·²åœ¨æœ€æ–°ç‰ˆæœ¬ä¸­ä¿®å¤ï¼Œç¡®ä¿æ¨¡å‹è¿”å›çš„å¢å¼ºå›¾åƒã€åå°„ç‡å›¾å’Œå…‰ç…§å›¾èƒ½å¤Ÿè¢«æ­£ç¡®è§£åŒ…ã€‚

## ğŸ“š å‚è€ƒæ–‡çŒ®

- Retinexç†è®ºï¼šLand, E. H. (1977). è§†ç½‘è†œç†è®ºä¸è‰²å½©è§†è§‰ã€‚ã€Šç§‘å­¦ç¾å›½äººã€‹ã€‚
- HIDO-Netï¼šç‰¹å¾èšåˆæ¨¡å—çµæ„Ÿæ¥æº

## ğŸ“ å¼•ç”¨

å¦‚æœæ‚¨åœ¨ç ”ç©¶ä¸­ä½¿ç”¨æ­¤ä»£ç ï¼Œè¯·å¼•ç”¨ï¼š
```
```

## ğŸ“… æ›´æ–°æ—¥å¿—

### v1.1.0 (2024-XX-XX)
- ä¿®å¤äº†IlluminationReflectanceDecouplingLossä¸­å…‰ç…§å›¾å’Œåå°„ç‡å›¾é€šé“æ•°ä¸åŒ¹é…å¯¼è‡´çš„RuntimeErroré—®é¢˜
- ä¸ºæ‰€æœ‰æŸå¤±å‡½æ•°æƒé‡å‚æ•°æ·»åŠ äº†é»˜è®¤å€¼å¤„ç†ï¼Œæé«˜ä»£ç å¥å£®æ€§
- æ›´æ–°äº†æ•…éšœæ’é™¤éƒ¨åˆ†ï¼Œæ·»åŠ äº†å¸¸è§é”™è¯¯çš„è§£å†³æ–¹æ¡ˆ
- ä¿®å¤äº†æ¨¡å‹è¿”å›å€¼è§£åŒ…é”™è¯¯(ValueError: too many values to unpack)ï¼Œç¡®ä¿å¢å¼ºæ¨¡å—èƒ½æ­£ç¡®å¤„ç†æ¨¡å‹è¿”å›çš„å¢å¼ºå›¾åƒã€åå°„ç‡å›¾å’Œå…‰ç…§å›¾